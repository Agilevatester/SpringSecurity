package com.example.tomcatcve202524813;

import org.apache.catalina.servlets.DefaultServlet;
import org.springframework.boot.web.servlet.ServletRegistrationBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
public class ServletConfig {

    @Bean
    public ServletRegistrationBean<DefaultServlet> customDefaultServlet() {
        ServletRegistrationBean<DefaultServlet> registrationBean =
                new ServletRegistrationBean<>(new DefaultServlet());

        // Map the servlet to handle all static content and PUT requests
        registrationBean.addUrlMappings("/static/*", "*.html", "*.js", "*.css", "*.txt", "/*");

        // Enable write permissions (required for the vulnerability)
        registrationBean.addInitParameter("readonly", "false");

        // Enable directory listings for demonstration purposes
        registrationBean.addInitParameter("listings", "true");

        // Enable debug mode
        registrationBean.addInitParameter("debug", "1");

        return registrationBean;
    }
}
